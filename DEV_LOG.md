🔭 Valuation Radar (宏观雷达) - DEV LOG
项目简介： 本项目是一个基于 Python + Streamlit + Plotly 的宏观大类资产战术扫描雷达。旨在通过可视化的量化指标（估值 Z-Score 与短期动量 Momentum），帮助宏观交易员一眼识别市场中的“拥挤/过热区”与“冷宫/超卖区”，剥离情绪噪音，辅助战术资产配置 (Tactical Asset Allocation)。

📅 [Version 1.0 - 1.2] 核心框架构建 & 基础量价模型
引擎确立： 使用 yfinance 作为基础数据源，拉取全球大类资产（股指、商品、美债、加密货币）。

X轴 (估值中枢)： 定义为 Z-Score。基于“滚动 1 年 (252交易日)”的均值和标准差计算。

逻辑：反映资产当前价格相对于自身过去一年平均成本的偏离度。

Y轴 (动量引擎)： 定义为 Momentum。计算“过去 4 周 (20交易日)”的涨跌幅。

逻辑：反映资金近期的短期攻击方向和加速度。

视觉规范定调： 确立了四个象限的实战意义（左上：反转/启动；右上：强势/拥挤；左下：弱势/冷宫；右下：补跌/崩盘）。

📅 [Version 1.3] 视觉减负：奥卡姆剃刀 (Less is More)
【变更】移除 Vol_Z 气泡大小控制： 早期版本尝试使用成交量 Z-Score 控制气泡大小 (Size)。

弃用原因： 资产过多时导致严重的视觉遮挡（大泡沫挡住小泡沫），严重影响对 X/Y 轴核心位置坐标的阅读体验。

现状： 图表统一采用固定大小的 Marker (size=14)。量能数据 (Vol_Z) 降级，仅在下方详细数据表格和鼠标悬停 (Hover) 时显示。

【变更】时间轴聚焦 1 年战术期： 早期版本展示完整的 10 年滚动回放。

优化原因： 过于久远的历史数据降低了工具的日频打开率。

现状： 图表滚动条默认且仅展示 最近 1 年 的演变。

⚠️ 核心技术警告： 尽管只展示 1 年，后台 start_date 必须至少拉取 2.5 年 的数据。因为第一天的 Z-Score 计算需要消耗它之前一整年的历史数据作为分母，切勿缩短数据拉取窗口，否则会导致前端数据截断报错。

📅 [Version 2.0] 资产池重构 & 引入金融工程 (合成指数)
【修复】消费板块的“伪装陷阱”： 发现传统宽基消费 ETF 失真。

动作： 严格拆分 可选消费 (XLY, 进攻矛) 与 必选消费 (XLP, 防御盾)。

【重大升级】定制合成组合 (Custom Baskets)：

痛点： 传统 ETF（如 XLP）包含过多垃圾成分股（如 WBA, DG），导致真正创历史新高的防御龙头（WMT, COST）的强势信号被平均值严重拖累、掩盖。

解决方案： 在后台数据处理层加入**“实时等权重合成指数”**逻辑。

新增组合： 1. 🚀 科技七姐妹 (NVDA, AAPL, MSFT, GOOG, AMZN, META, TSLA) - 剥离 QQQ 冗余。 2. 🛡️ 必选消费精英 (WMT, COST, KO, PG, PEP) - 纯血统防御盾。

计算方法： 提取成分股每日 Return -> 计算截面均值 -> 累乘还原 Net Asset Value (NAV)。

📝 [NEXT STEPS] 待办事项与已知缺陷 (Backlog for Next Dev)
⚠️ 缺陷记录 (The "Natural Gas" Trap)： * 当前 Y 轴纯看 20 天绝对涨幅，导致具有极高波动率且处于长期熊市的资产（如天然气 UNG 产生的“死猫跳”）会获得极高的 Y 轴评分，容易误导为优质做多信号。

相反，真正走势极其稳健的“慢牛”资产（如 WMT, COST），因为单月涨幅绝对值不大，在 Y 轴上表现平平。

🎯 下一版开发目标 (V2.1 任务)：重构 Y 轴动量算法

需求描述： 将 Y 轴从“绝对动量”升级为 “风险调整后动量 (Risk-Adjusted Momentum)”。

算法建议： 引入夏普比率 (Sharpe Ratio) 思想。新 Y 轴 = 20日涨幅 / 20日年化波动率。

预期效果： 惩罚“上蹿下跳”的劣质资产，奖励“每天涨一点，几乎不回撤”的优质资产。让稳稳的幸福在雷达上起飞。